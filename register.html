<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Registration | Shri Sai Infotech</title>
    <link rel="icon" type="image/x-icon" href="images/logo.png">
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <style>
        body { background: #f4f6fa; }
        .reg-container { max-width: 800px; margin: 120px auto 50px; background: white; padding: 40px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 600; font-size: 0.9rem; color: #0A1F44; }
        .form-group input, .form-group select, .form-group textarea { 
            width: 100%; padding: 12px; border: 1px solid #cbd5e1; border-radius: 6px; font-family: 'DM Sans', sans-serif; transition: 0.3s; 
        }
        .form-group input:focus { border-color: #F5A623; outline: none; }
        .full-width { grid-column: span 2; }
        
        @media(max-width: 600px) { 
            .form-grid { grid-template-columns: 1fr; } 
            .full-width { grid-column: span 1; } 
        }
        
        /* Progress Indicator */
        .progress-bar { width: 100%; height: 5px; background: #e2e8f0; margin-bottom: 30px; border-radius: 5px; overflow: hidden; }
        .progress-fill { height: 100%; width: 0%; background: #F5A623; transition: width 0.5s ease; }
    </style>
</head>
<body>
    <nav class="navbar" style="background: #0A1F44;">
        <div class="container">
            <a href="index.html" class="logo"><i class="fa-solid fa-laptop-code"></i> SHRI SAI INFOTECH</a>
            
            <ul class="nav-links" id="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="login.html">Login</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <div class="reg-container">
            <h2 style="text-align: center; color: #0A1F44; margin-bottom: 10px;">Student Registration</h2>
            <p style="text-align: center; color: #666; margin-bottom: 30px;">Join us to kickstart your technical journey.</p>
            
            <div class="progress-bar"><div class="progress-fill" id="progressBar"></div></div>

            <form id="regForm" onsubmit="handleRegister(event)">
                <div class="form-grid">
                    <div class="form-group">
                        <label>Full Name <span style="color:red">*</span></label>
                        <input type="text" name="fullName" required placeholder="Enter full name" oninput="updateProgress()">
                    </div>
                    <div class="form-group">
                        <label>Father's Name <span style="color:red">*</span></label>
                        <input type="text" name="fatherName" required placeholder="Enter father's name" oninput="updateProgress()">
                    </div>
                    <div class="form-group">
                        <label>Date of Birth</label>
                        <input type="date" name="dob" required oninput="updateProgress()">
                    </div>
                    <div class="form-group">
                        <label>Mobile Number <span style="color:red">*</span></label>
                        <input type="tel" name="mobile" required placeholder="10 digit mobile number" pattern="[0-9]{10}" oninput="updateProgress()">
                    </div>
                    <div class="form-group">
                        <label>Email Address <span style="color:red">*</span></label>
                        <input type="email" name="email" required placeholder="you@example.com" oninput="updateProgress()">
                    </div>
                    <div class="form-group">
                        <label>Gender</label>
                        <select name="gender">
                            <option>Male</option>
                            <option>Female</option>
                            <option>Other</option>
                        </select>
                    </div>
                    <div class="form-group full-width">
                        <label>Address</label>
                        <textarea name="address" rows="3" placeholder="Full residential address" oninput="updateProgress()"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Select Course</label>
                        <select name="courseId" id="courseSelect">
                            <option value="1">Web Development (Short-Term)</option>
                            <option value="2">Python Mastery (Short-Term)</option>
                            <option value="3">O Level (Long-Term)</option>
                            <option value="4">Tally Prime (Short-Term)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Upload Photo</label>
                        <input type="file" accept="image/*">
                    </div>
                    <div class="form-group">
                        <label>Create Password <span style="color:red">*</span></label>
                        <input type="password" name="password" required oninput="updateProgress()">
                    </div>
                    <div class="form-group">
                        <label>Confirm Password <span style="color:red">*</span></label>
                        <input type="password" required oninput="updateProgress()">
                    </div>
                </div>

                <div style="margin-top: 30px; text-align: center;">
                    <button type="submit" class="btn btn-primary" style="padding: 15px 40px; font-size: 1rem;">Complete Registration</button>
                </div>
            </form>
        </div>
    </div>

    <script src="js/main.js"></script>
    <script>
        // Simple progress bar logic
        function updateProgress() {
            const inputs = document.querySelectorAll('input, textarea');
            let filled = 0;
            inputs.forEach(input => {
                if(input.value.length > 0) filled++;
            });
            const percent = (filled / inputs.length) * 100;
            document.getElementById('progressBar').style.width = percent + '%';
        }

        async function handleRegister(e) {
            e.preventDefault();
            const btn = e.target.querySelector('button');
            const originalText = btn.innerText;
            
            btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Processing...';
            btn.disabled = true;

            // Gather form data
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData.entries());

            try {
                // Sending to our Backend API
                const response = await fetch('http://localhost:5000/api/auth/register', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();

                if (response.ok) {
                    alert("Registration Successful! Please login.");
                    window.location.href = 'login.html';
                } else {
                    alert(result.message || "Registration failed.");
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                }
            } catch (error) {
                console.error(error);
                // Fallback for demo purposes if backend isn't running
                alert("Simulated: Registration Successful! (Backend not reachable)");
                window.location.href = 'login.html';
            }
        }
    </script>
</body>
</html>